#!/bin/bash

DOCKER_REPO=${DOCKER_REPO:-fopina/pokebox}
VERSION=$(cat VERSION)
echo "Build hook running"
echo "Building for x84_64..."
docker build -t $DOCKER_REPO:$VERSION \
			 -f Dockerfile .
echo "Building for arm32v6..."
# once there is a host to build arm images, same dockerfile can be used with
# --build-arg BASE='arm32v6/python:2.7.14-alpine3.6'
sed -e '/^#.*# hub_arm_hack/s/^#//g' Dockerfile > Dockerfile.arm
docker build -t $DOCKER_REPO:arm-$VERSION \
			 --build-arg BASE='fopina/alpine-arm:3.6' \
			 -f Dockerfile.arm .